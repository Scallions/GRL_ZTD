import numpy as np

pres = np.array([1020, 1000, 997, 925, 850, 830, 751, 716, 700, 673, 633, 574, 538, 500, 468, 400, 399, 324, 300, 279, 274, 250, 229, 227, 223, 212, 203, 200, 167, 152, 150, 133, 100])
gph = np.array([2, 173, 201, 845, 1566, 1769, 2598, 2989, 3173, 3499, 3989, 4759, 5260, 5819, 6330, 7495, 7518, 9003, 9534, 10021, 10142, 10751, 11322, 11379, 11494, 11825, 12110, 12207, 13370, 13972, 14057, 14827, 16633])
temp = np.array([20.8500000000000, 22.2500000000000, 22.4500000000000, 18.4500000000000, 13.6500000000000, 11.8500000000000, 8.45000000000005, 5.05000000000001, 4.45000000000005, 2.45000000000005, -1.64999999999998, -6.64999999999998, -11.0500000000000, -13.6500000000000, -15.8500000000000, -23.2500000000000, -23.2500000000000, -35.4500000000000, -39.6500000000000, -44.0500000000000, -44.2500000000000, -48.2500000000000, -52.2500000000000, -52.2500000000000, -51.0500000000000, -48.0500000000000, -49.4500000000000, -50.2500000000000, -56.2500000000000, -53.0500000000000, -53.6500000000000, -56.8500000000000, -56.6500000000000])
rh = np.array([84, 73.3000000000000, 68.8000000000000, 74.6000000000000, 75.2000000000000, 82.4000000000000, 61.3000000000000, 90.6000000000000, 78.5000000000000, 69.5000000000000, 98.5000000000000, 76.7000000000000, 84.5000000000000, 84.8000000000000, 84.6000000000000, 78.5000000000000, 77.1000000000000, 72.5000000000000, 63.6000000000000, 60.2000000000000, 62.3000000000000, 61.8000000000000, 48.5000000000000, 37.8000000000000, 0.900000000000000, 4.70000000000000, 12.1000000000000, 11.9000000000000, 6.60000000000000, 1.10000000000000, 1.10000000000000, 0.900000000000000, 0.900000000000000])

temp = temp+273.15

# compute var pres
e_sat = 0.611*np.exp((17.2694*temp)/(temp+273.15-35.86))
e_sat = e_sat*10
vap_pres = rh*e_sat/100

Tm_a = 0
Tm_b = 0
for x in range(0, len(pres)-1):
    Tm_a = Tm_a + (gph[x+1]-gph[x])*vap_pres[x]/temp[x]
    Tm_b = Tm_b + (gph[x+1]-gph[x])*vap_pres[x]/(temp[x])**2

print("Tm: ", Tm_a/Tm_b)